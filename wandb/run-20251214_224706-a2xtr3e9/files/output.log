Epoch 1:   0%|                          | 0/56250 [00:00<?, ?it/s]/opt/miniconda3/lib/python3.13/site-packages/torch/utils/data/dataloader.py:692: UserWarning: 'pin_memory' argument is set as true but not supported on MPS now, device pinned memory won't be used.
  warnings.warn(warn_msg)
Traceback (most recent call last):                                
  File "/Users/maianhpham/Documents/MediTranslator/scripts/train.py", line 237, in <module>
    main()
    ~~~~^^
  File "/Users/maianhpham/Documents/MediTranslator/scripts/train.py", line 231, in main
    trainer.train()
    ~~~~~~~~~~~~~^^
  File "/Users/maianhpham/Documents/MediTranslator/src/training/trainer.py", line 323, in train
    train_loss = self.train_epoch(epoch)
  File "/Users/maianhpham/Documents/MediTranslator/src/training/trainer.py", line 219, in train_epoch
    self.optimizer.step()
    ~~~~~~~~~~~~~~~~~~~^^
  File "/opt/miniconda3/lib/python3.13/site-packages/torch/optim/optimizer.py", line 517, in wrapper
    out = func(*args, **kwargs)
  File "/opt/miniconda3/lib/python3.13/site-packages/torch/optim/optimizer.py", line 82, in _use_grad
    ret = func(*args, **kwargs)
  File "/opt/miniconda3/lib/python3.13/site-packages/torch/optim/adam.py", line 247, in step
    adam(
    ~~~~^
        params_with_grad,
        ^^^^^^^^^^^^^^^^^
    ...<19 lines>...
        decoupled_weight_decay=group["decoupled_weight_decay"],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/opt/miniconda3/lib/python3.13/site-packages/torch/optim/optimizer.py", line 150, in maybe_fallback
    return func(*args, **kwargs)
  File "/opt/miniconda3/lib/python3.13/site-packages/torch/optim/adam.py", line 953, in adam
    func(
    ~~~~^
        params,
        ^^^^^^^
    ...<17 lines>...
        decoupled_weight_decay=decoupled_weight_decay,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/opt/miniconda3/lib/python3.13/site-packages/torch/optim/adam.py", line 535, in _single_tensor_adam
    denom = (exp_avg_sq.sqrt() / bias_correction2_sqrt).add_(eps)
             ~~~~~~~~~~~~~~~^^
RuntimeError: MPS backend out of memory (MPS allocated: 11.32 GiB, other allocations: 15.73 GiB, max allowed: 27.20 GiB). Tried to allocate 195.31 MiB on private pool. Use PYTORCH_MPS_HIGH_WATERMARK_RATIO=0.0 to disable upper limit for memory allocations (may cause system failure).
